#!/usr/bin/env python3
"""
Add i18n keys for 4 admin pages to all 22 locale files.
Namespaces: admin.permissions, admin.employees, admin.settingsPage, admin.uat
"""

import json
import os
import glob

LOCALES_DIR = os.path.join(os.path.dirname(__file__), '..', 'src', 'i18n', 'locales')

# ─── French translations (fr.json) ───

fr_permissions = {
    "title": "Permissions",
    "subtitle": "Gérer les rôles par défaut, les groupes de permissions et les dérogations par utilisateur",
    "ownerOnly": "OWNER uniquement",
    "tabDefaults": "Rôles par défaut",
    "tabGroups": "Groupes de permissions",
    "tabOverrides": "Dérogations utilisateur",
    "permission": "Permission",
    "owner": "Propriétaire",
    "employee": "Employé",
    "client": "Client",
    "customer": "Client final",
    "newGroup": "Nouveau groupe",
    "noGroupsTitle": "Aucun groupe de permissions",
    "noGroupsDescription": "Créez des groupes pour regrouper les permissions et les assigner aux utilisateurs.",
    "createFirstGroup": "Créer le premier groupe",
    "editGroup": "Modifier le groupe de permissions",
    "newGroupTitle": "Nouveau groupe de permissions",
    "cancel": "Annuler",
    "saveGroup": "Sauvegarder le groupe",
    "groupName": "Nom du groupe",
    "groupNamePlaceholder": "Ex : Chef de produit",
    "descriptionLabel": "Description",
    "descriptionPlaceholder": "À quoi sert ce groupe...",
    "color": "Couleur",
    "permissionsLabel": "Permissions",
    "usersCount": "{count} utilisateurs",
    "edit": "Modifier",
    "morePermissions": "+{count} de plus",
    "deleteGroupConfirm": "Supprimer ce groupe de permissions ?",
    "searchUser": "Rechercher un utilisateur",
    "searchPlaceholder": "Rechercher par nom ou email...",
    "overrideCol": "Dérogation",
    "actionsCol": "Actions",
    "grant": "Accorder",
    "revoke": "Révoquer",
    "removeOverrideTitle": "Supprimer la dérogation (utiliser le rôle par défaut)",
    "changeUser": "Changer d'utilisateur",
    "selectUserTitle": "Sélectionnez un utilisateur",
    "selectUserDescription": "Recherchez un utilisateur ci-dessus pour gérer ses dérogations de permissions individuelles."
}

fr_employees = {
    "title": "Employés",
    "subtitle": "Gérez les accès de votre équipe",
    "inviteEmployee": "Inviter un employé",
    "total": "Total",
    "active": "Actifs",
    "owners": "Propriétaires",
    "employeeCol": "Employé",
    "roleCol": "Rôle",
    "permissionsCol": "Permissions",
    "lastLogin": "Dernière connexion",
    "statusCol": "Statut",
    "actionsCol": "Actions",
    "allPermissions": "Toutes",
    "permissionsCount": "{count} permissions",
    "never": "Jamais",
    "editBtn": "Modifier",
    "editAccess": "Modifier les accès",
    "inviteTitle": "Inviter un employé",
    "emailLabel": "Email",
    "nameLabel": "Nom",
    "roleLabel": "Rôle",
    "roleEmployee": "Employé",
    "roleOwner": "Propriétaire (tous les accès)",
    "permissionsLabel": "Permissions",
    "cancelBtn": "Annuler",
    "saveBtn": "Sauvegarder",
    "sendInvitation": "Envoyer l'invitation",
    "permViewOrders": "Voir les commandes",
    "permManageOrders": "Gérer les commandes",
    "permViewProducts": "Voir les produits",
    "permManageProducts": "Gérer les produits",
    "permViewCustomers": "Voir les clients",
    "permManageCustomers": "Gérer les clients",
    "permViewInventory": "Voir l'inventaire",
    "permManageInventory": "Gérer l'inventaire",
    "permMarketing": "Marketing (promos, newsletter)",
    "permModerateReviews": "Modérer les avis",
    "permRespondChat": "Répondre au chat",
    "permViewReports": "Voir les rapports",
    "permManageSettings": "Gérer les paramètres",
    "permManageEmployees": "Gérer les employés"
}

fr_settingsPage = {
    "sidebarTitle": "Paramètres",
    "general": "Général",
    "store": "Boutique",
    "orders": "Commandes",
    "notifications": "Notifications",
    "security": "Sécurité",
    "integrations": "Intégrations",
    "generalTitle": "Paramètres généraux",
    "siteName": "Nom du site",
    "mainEmail": "Email principal",
    "supportEmail": "Email support",
    "phone": "Téléphone",
    "timezone": "Fuseau horaire",
    "storeTitle": "Paramètres boutique",
    "defaultCurrency": "Devise par défaut",
    "cadOption": "Dollar canadien (CAD)",
    "usdOption": "Dollar américain (USD)",
    "eurOption": "Euro (EUR)",
    "freeShippingThreshold": "Seuil livraison gratuite ($)",
    "weightUnit": "Unité de poids",
    "gramsOption": "Grammes (g)",
    "kilogramsOption": "Kilogrammes (kg)",
    "ouncesOption": "Onces (oz)",
    "poundsOption": "Livres (lb)",
    "dimensionUnit": "Unité de dimension",
    "centimetersOption": "Centimètres (cm)",
    "inchesOption": "Pouces (in)",
    "ordersTitle": "Paramètres commandes",
    "orderPrefix": "Préfixe commande",
    "orderPrefixHint": "Ex : BC-2026-00001",
    "minOrder": "Commande minimum ($)",
    "maxOrder": "Commande maximum ($)",
    "guestCheckout": "Autoriser le checkout invité",
    "notificationsTitle": "Notifications",
    "newOrders": "Nouvelles commandes",
    "newOrdersDesc": "Recevoir un email pour chaque nouvelle commande",
    "lowStockAlerts": "Alertes stock bas",
    "lowStockAlertsDesc": "Notification quand un produit atteint le seuil minimum",
    "newReviews": "Nouveaux avis",
    "newReviewsDesc": "Notification pour chaque nouvel avis client",
    "securityTitle": "Sécurité",
    "emailVerification": "Vérification email obligatoire",
    "emailVerificationDesc": "Les utilisateurs doivent vérifier leur email",
    "sessionTimeout": "Timeout session (min)",
    "maxLoginAttempts": "Max tentatives connexion",
    "integrationsTitle": "Intégrations",
    "cardPayments": "Paiements par carte",
    "paypalPayments": "Paiements PayPal",
    "trafficStats": "Statistiques de trafic",
    "emailSending": "Envoi d'emails",
    "connected": "Connecté",
    "configure": "Configurer",
    "saving": "Sauvegarde...",
    "saveSettings": "Sauvegarder les paramètres",
    "settingsSaved": "Paramètres sauvegardés !"
}

fr_uat = {
    "title": "Tests UAT — AureliaPay",
    "subtitle": "Pipeline comptable automatisé : Order → Payment → Inventory → COGS → Invoice → Journal",
    "launchTest": "Lancer un test",
    "newRunTitle": "Nouveau run UAT",
    "canadaOnly": "Canada seulement",
    "canadaOnlyDesc34": "34 scénarios (toutes les provinces)",
    "canadaOnlyDesc49": "49 scénarios (Canada + International)",
    "intlWarning": "Les scénarios internationaux ne calculent pas de taxes canadiennes. Multi-devises non encore supporté.",
    "provincesInfo": "Provinces couvertes : QC, ON, BC, AB, SK, MB, NS, NB, NL, PE, NT, YT, NU",
    "scenariosInfo": "Scénarios : vente simple, multi-produit, remboursement, ré-expédition, arrondis",
    "verificationsInfo": "Vérifications : taxes, inventaire, COGS, écritures, factures, équilibre D/C",
    "cancelBtn": "Annuler",
    "startBtn": "Démarrer ({count} scénarios)",
    "runHistory": "Historique des runs",
    "noRuns": "Aucun run UAT. Lancez votre premier test !",
    "dateCol": "Date",
    "statusCol": "Statut",
    "scopeCol": "Scope",
    "scenariosCol": "Scénarios",
    "passedCol": "Passés",
    "failedCol": "Échoués",
    "durationCol": "Durée",
    "actionsCol": "Actions",
    "viewDetail": "Voir détail",
    "cleanData": "Nettoyer données",
    "cleanedUp": "nettoyé",
    "canada": "Canada",
    "global": "Global",
    "loadingDetail": "Chargement du détail...",
    "cleanupConfirm": "Supprimer TOUTES les données de test de ce run ?\n\nCommandes, écritures, factures, transactions inventaire seront supprimées.\nLe stock sera restauré.",
    "cleanupDone": "Nettoyage terminé !",
    "launchError": "Erreur lors du lancement",
    "unknownError": "Erreur inconnue",
    "errorPrefix": "Erreur : ",
    "cleanup": "Nettoyer",
    "close": "Fermer",
    "totalLabel": "Total",
    "passedLabel": "Passés",
    "failedLabel": "Échoués",
    "skippedLabel": "Sautés",
    "testCasesTab": "Test Cases",
    "taxReportTab": "Rapport Taxes",
    "errorsTab": "Erreurs",
    "expectedTaxes": "Taxes attendues",
    "actualTaxes": "Taxes réelles",
    "expectedTotal": "Total attendu",
    "actualTotal": "Total réel",
    "verifications": "Vérifications",
    "errorsCount": "Erreurs ({count})",
    "noErrors": "Aucune erreur !",
    "expected": "Attendu",
    "actual": "Obtenu",
    "region": "Région",
    "sales": "Ventes",
    "totalSales": "Total ventes",
    "totalTaxes": "Total taxes",
    "expectedCol": "Attendu",
    "difference": "Écart",
    "totalRow": "TOTAL"
}

# ─── English translations (en.json and all other locales) ───

en_permissions = {
    "title": "Permissions",
    "subtitle": "Manage role defaults, permission groups, and per-user overrides",
    "ownerOnly": "OWNER Only",
    "tabDefaults": "Role Defaults",
    "tabGroups": "Permission Groups",
    "tabOverrides": "User Overrides",
    "permission": "Permission",
    "owner": "Owner",
    "employee": "Employee",
    "client": "Client",
    "customer": "Customer",
    "newGroup": "New Group",
    "noGroupsTitle": "No permission groups yet",
    "noGroupsDescription": "Create groups to bundle permissions and assign them to users.",
    "createFirstGroup": "Create First Group",
    "editGroup": "Edit Permission Group",
    "newGroupTitle": "New Permission Group",
    "cancel": "Cancel",
    "saveGroup": "Save Group",
    "groupName": "Group Name",
    "groupNamePlaceholder": "e.g., Product Manager",
    "descriptionLabel": "Description",
    "descriptionPlaceholder": "What this group is for...",
    "color": "Color",
    "permissionsLabel": "Permissions",
    "usersCount": "{count} users",
    "edit": "Edit",
    "morePermissions": "+{count} more",
    "deleteGroupConfirm": "Delete this permission group?",
    "searchUser": "Search User",
    "searchPlaceholder": "Search by name or email...",
    "overrideCol": "Override",
    "actionsCol": "Actions",
    "grant": "Grant",
    "revoke": "Revoke",
    "removeOverrideTitle": "Remove override (use role default)",
    "changeUser": "Change User",
    "selectUserTitle": "Select a user",
    "selectUserDescription": "Search for a user above to manage their individual permission overrides."
}

en_employees = {
    "title": "Employees",
    "subtitle": "Manage your team's access",
    "inviteEmployee": "Invite an employee",
    "total": "Total",
    "active": "Active",
    "owners": "Owners",
    "employeeCol": "Employee",
    "roleCol": "Role",
    "permissionsCol": "Permissions",
    "lastLogin": "Last Login",
    "statusCol": "Status",
    "actionsCol": "Actions",
    "allPermissions": "All",
    "permissionsCount": "{count} permissions",
    "never": "Never",
    "editBtn": "Edit",
    "editAccess": "Edit Access",
    "inviteTitle": "Invite an Employee",
    "emailLabel": "Email",
    "nameLabel": "Name",
    "roleLabel": "Role",
    "roleEmployee": "Employee",
    "roleOwner": "Owner (all access)",
    "permissionsLabel": "Permissions",
    "cancelBtn": "Cancel",
    "saveBtn": "Save",
    "sendInvitation": "Send Invitation",
    "permViewOrders": "View orders",
    "permManageOrders": "Manage orders",
    "permViewProducts": "View products",
    "permManageProducts": "Manage products",
    "permViewCustomers": "View customers",
    "permManageCustomers": "Manage customers",
    "permViewInventory": "View inventory",
    "permManageInventory": "Manage inventory",
    "permMarketing": "Marketing (promos, newsletter)",
    "permModerateReviews": "Moderate reviews",
    "permRespondChat": "Respond to chat",
    "permViewReports": "View reports",
    "permManageSettings": "Manage settings",
    "permManageEmployees": "Manage employees"
}

en_settingsPage = {
    "sidebarTitle": "Settings",
    "general": "General",
    "store": "Store",
    "orders": "Orders",
    "notifications": "Notifications",
    "security": "Security",
    "integrations": "Integrations",
    "generalTitle": "General Settings",
    "siteName": "Site Name",
    "mainEmail": "Main Email",
    "supportEmail": "Support Email",
    "phone": "Phone",
    "timezone": "Timezone",
    "storeTitle": "Store Settings",
    "defaultCurrency": "Default Currency",
    "cadOption": "Canadian Dollar (CAD)",
    "usdOption": "US Dollar (USD)",
    "eurOption": "Euro (EUR)",
    "freeShippingThreshold": "Free Shipping Threshold ($)",
    "weightUnit": "Weight Unit",
    "gramsOption": "Grams (g)",
    "kilogramsOption": "Kilograms (kg)",
    "ouncesOption": "Ounces (oz)",
    "poundsOption": "Pounds (lb)",
    "dimensionUnit": "Dimension Unit",
    "centimetersOption": "Centimeters (cm)",
    "inchesOption": "Inches (in)",
    "ordersTitle": "Order Settings",
    "orderPrefix": "Order Prefix",
    "orderPrefixHint": "e.g., BC-2026-00001",
    "minOrder": "Minimum Order ($)",
    "maxOrder": "Maximum Order ($)",
    "guestCheckout": "Allow guest checkout",
    "notificationsTitle": "Notifications",
    "newOrders": "New Orders",
    "newOrdersDesc": "Receive an email for each new order",
    "lowStockAlerts": "Low Stock Alerts",
    "lowStockAlertsDesc": "Notification when a product reaches minimum threshold",
    "newReviews": "New Reviews",
    "newReviewsDesc": "Notification for each new customer review",
    "securityTitle": "Security",
    "emailVerification": "Require Email Verification",
    "emailVerificationDesc": "Users must verify their email",
    "sessionTimeout": "Session Timeout (min)",
    "maxLoginAttempts": "Max Login Attempts",
    "integrationsTitle": "Integrations",
    "cardPayments": "Card Payments",
    "paypalPayments": "PayPal Payments",
    "trafficStats": "Traffic Statistics",
    "emailSending": "Email Sending",
    "connected": "Connected",
    "configure": "Configure",
    "saving": "Saving...",
    "saveSettings": "Save Settings",
    "settingsSaved": "Settings saved!"
}

en_uat = {
    "title": "UAT Tests — AureliaPay",
    "subtitle": "Automated accounting pipeline: Order → Payment → Inventory → COGS → Invoice → Journal",
    "launchTest": "Launch Test",
    "newRunTitle": "New UAT Run",
    "canadaOnly": "Canada only",
    "canadaOnlyDesc34": "34 scenarios (all provinces)",
    "canadaOnlyDesc49": "49 scenarios (Canada + International)",
    "intlWarning": "International scenarios do not calculate Canadian taxes. Multi-currency not yet supported.",
    "provincesInfo": "Provinces covered: QC, ON, BC, AB, SK, MB, NS, NB, NL, PE, NT, YT, NU",
    "scenariosInfo": "Scenarios: simple sale, multi-product, refund, re-shipment, rounding",
    "verificationsInfo": "Verifications: taxes, inventory, COGS, entries, invoices, D/C balance",
    "cancelBtn": "Cancel",
    "startBtn": "Start ({count} scenarios)",
    "runHistory": "Run History",
    "noRuns": "No UAT runs. Launch your first test!",
    "dateCol": "Date",
    "statusCol": "Status",
    "scopeCol": "Scope",
    "scenariosCol": "Scenarios",
    "passedCol": "Passed",
    "failedCol": "Failed",
    "durationCol": "Duration",
    "actionsCol": "Actions",
    "viewDetail": "View Detail",
    "cleanData": "Clean Data",
    "cleanedUp": "cleaned",
    "canada": "Canada",
    "global": "Global",
    "loadingDetail": "Loading detail...",
    "cleanupConfirm": "Delete ALL test data from this run?\n\nOrders, entries, invoices, inventory transactions will be deleted.\nStock will be restored.",
    "cleanupDone": "Cleanup complete!",
    "launchError": "Error during launch",
    "unknownError": "Unknown error",
    "errorPrefix": "Error: ",
    "cleanup": "Clean up",
    "close": "Close",
    "totalLabel": "Total",
    "passedLabel": "Passed",
    "failedLabel": "Failed",
    "skippedLabel": "Skipped",
    "testCasesTab": "Test Cases",
    "taxReportTab": "Tax Report",
    "errorsTab": "Errors",
    "expectedTaxes": "Expected Taxes",
    "actualTaxes": "Actual Taxes",
    "expectedTotal": "Expected Total",
    "actualTotal": "Actual Total",
    "verifications": "Verifications",
    "errorsCount": "Errors ({count})",
    "noErrors": "No errors!",
    "expected": "Expected",
    "actual": "Actual",
    "region": "Region",
    "sales": "Sales",
    "totalSales": "Total Sales",
    "totalTaxes": "Total Taxes",
    "expectedCol": "Expected",
    "difference": "Difference",
    "totalRow": "TOTAL"
}


def main():
    locale_files = sorted(glob.glob(os.path.join(LOCALES_DIR, '*.json')))
    print(f"Found {len(locale_files)} locale files")

    for filepath in locale_files:
        filename = os.path.basename(filepath)
        locale_code = filename.replace('.json', '')

        with open(filepath, 'r', encoding='utf-8') as f:
            data = json.load(f)

        if 'admin' not in data:
            data['admin'] = {}

        # Check if already added
        if 'permissions' in data['admin']:
            print(f"  {filename}: already has admin.permissions, skipping...")
            continue

        # Use French for fr.json, English for all others
        if locale_code == 'fr':
            data['admin']['permissions'] = fr_permissions
            data['admin']['employees'] = fr_employees
            data['admin']['settingsPage'] = fr_settingsPage
            data['admin']['uat'] = fr_uat
        else:
            data['admin']['permissions'] = en_permissions
            data['admin']['employees'] = en_employees
            data['admin']['settingsPage'] = en_settingsPage
            data['admin']['uat'] = en_uat

        with open(filepath, 'w', encoding='utf-8') as f:
            json.dump(data, f, ensure_ascii=False, indent=2)
            f.write('\n')

        print(f"  {filename}: added 4 namespaces under admin")

    print("\nDone! All locale files updated.")


if __name__ == '__main__':
    main()
